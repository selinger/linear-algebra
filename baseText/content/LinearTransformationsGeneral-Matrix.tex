\section{The matrix of a linear transformation}

\begin{outcome}
  \begin{enumerate}
  \item Find the matrix of a linear transformation with respect to
    general bases in vector spaces.
  \end{enumerate}
\end{outcome}

In Section~\ref{sec:matrix-of-transformation}, we saw that linear
transformations $T:\R^n\to\R^m$ are in one-to-one correspondence with
$m\times n$-matrices. Here, we will generalize this correspondence to
arbitrary finite-dimensional vector spaces. There is an important
difference, however. While $\R^n$ comes with a natural coordinate
system (i.e., every vector in $\R^n$ has a first component, second
component, and so on), there is no distinguished coordinate system on
an arbitrary vector space. To define the matrix of a linear
transformation $T:V\to W$, we must first choose a basis, or
equivalently a coordinate system, for $V$ and for $W$. Different
choices of basis will give rise to different matrices.

Let $V$ be a vector space with basis
$B=\set{\vect{v}_1,\ldots,\vect{v}_n}$. Recall from
Section~\ref{ssec:bases-and-coordinates} that the \textbf{coordinates}
of a vector $\vect{v}$ with respect to the basis $B$%
\index{coordinate!with respect to basis}%
\index{coordinate system!and basis} are the unique scalars
$a_1,\ldots,a_n$ such that
\begin{equation*}
  \vect{v} = a_1\,\vect{v}_1 + \ldots + a_n\,\vect{v}_n.
\end{equation*}
As before, we write
\begin{equation*}
  \coord{\vect{v}}_B = \begin{mymatrix}{c} a_1 \\ \vdots \\ a_n \end{mymatrix}
\end{equation*}
to denote the coordinates of $\vect{v}$ with respect to the basis $B$.
We will now see how to use bases and coordinates to encode any linear
map between finite-dimensional vector spaces as a matrix.

\begin{proposition}{The matrix of a linear transformation}{matrix-of-linear-transformation-vector-space}
  Let $V$ and $W$ be finite-dimensional vector spaces over a field
  $K$. Assume $B$ is a basis of $V$ and $C$ is a basis of $W$.  Let
  $T:V\to W$ be a linear transformation. Then there exists a unique
  $m\times n$-matrix $A$ such that for all $\vect{v}\in V$,
  \begin{equation*}
    A\coord{\vect{v}}_B = \coord{T\vect{v}}_C.
  \end{equation*}
  Moreover, $A$ can be computed as follows: the $i\th$ column of $A$
  holds the coordinates of $T(\vect{v}_i)$, where $\vect{v}_i$ is the
  $i\th$ vector of the basis $B$, and the coordinates are computed
  with respect to the basis $C$.
\end{proposition}

\begin{proof}
  Let $B=\set{\vect{v}_1,\ldots,\vect{v}_n}$ and
  $C=\set{\vect{w}_1,\ldots,\vect{w}_m}$.  By
  Theorem~\ref{thm:transformation-basis}, the linear transformation
  $T$ is completely determined by the images of the basis vectors,
  $T(\vect{v}_1),\ldots,T(\vect{v}_n)\in W$. Since
  $\set{\vect{w}_1,\ldots,\vect{w}_m}$ is a basis of $W$, we can write
  each $T(\vect{v}_i)$ as a linear combination of
  $\vect{w}_1,\ldots,\vect{w}_m$:
  \begin{eqnarray*}
    T(\vect{v}_1)
    &=& a_{11}\vect{w}_1 + a_{21}\vect{w}_2 + \ldots + a_{m1}\vect{w}_m, \\
    T(\vect{v}_2)
    &=& a_{12}\vect{w}_1 + a_{22}\vect{w}_2 + \ldots + a_{m2}\vect{w}_m, \\
    &\cdots& \\
    T(\vect{v}_n)
    &=& a_{1n}\vect{w}_1 + a_{2n}\vect{w}_2 + \ldots + a_{mn}\vect{w}_m.
  \end{eqnarray*}
  Let
  \begin{equation*}
    A = \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      \vdots & \vdots & \ddots & \vdots \\
      a_{m1} & a_{m2} & \cdots & a_{mn} \\
    \end{mymatrix}.
  \end{equation*}
  Then $A$ is an $m\times n$-matrix. We must prove that it has the
  desired property, i.e., that
  $A\coord{\vect{v}}_B = \coord{T\vect{v}}_C$, for all
  $\vect{v}\in V$. Since both the left-hand side and the right-hand
  side are linear functions of $\vect{v}$, it suffices to check that
  this property holds for basis vectors. Consider, therefore, one of
  the basis vectors $\vect{v}_i$.  Note that
  $\vect{v}_i = 0\vect{v}_1 + 0\vect{v}_2 + \ldots + 1\vect{v}_i +
  \ldots + 0\vect{v}_n$. Therefore, the coordinates of $\vect{v}_i$
  with respect to the basis $B$ are
  \begin{equation*}
    \coord{\vect{v}_i}_B =
    \begin{mysmallmatrix}{c}
      0 \\ \vdots \\ 1 \\ \vdots \\ 0
    \end{mysmallmatrix}
    = \vect{e}_i,
  \end{equation*}
  where $\vect{e}_i$ is the usual $i\th$ standard basis vector.  On
  the other hand, since
  $T(\vect{v}_i) = a_{1i}\vect{w}_1 + \ldots + a_{mi}\vect{w}_m$,
  we have
  \begin{equation*}
    \coord{T(\vect{v}_i)}_C =
    \begin{mysmallmatrix}{c}
      a_{1i} \\ \vdots \\ a_{mi}
    \end{mysmallmatrix}
    = A\vect{e}_i.
  \end{equation*}
  Here, in the last equation, we have used the fact that $A\vect{e}_i$
  is the same thing as the $i\th$ column of $A$. We therefore have
  $\coord{T(\vect{v}_i)}_C = A\vect{e}_i = A \coord{\vect{v}_i}_B$, as
  desired.
\end{proof}

\begin{definition}{The matrix of a linear transformation}{matrix-of-linear-transformation-vector-space}
  The matrix $A$ of
  Proposition~\ref{prop:matrix-of-linear-transformation-vector-space} is called the
  \textbf{matrix of the linear transformation\/ $T$ with respect to
    the bases $B$ and $C$}%
  \index{linear transformation!matrix of!w.r.t. basis}%
  \index{matrix!of a linear transformation!w.r.t. basis}.  We also
  write
  \begin{equation*}
    A = \coord{T}_{C,B}.
  \end{equation*}
  Therefore,
  \begin{equation*}
    \coord{T}_{C,B}\coord{\vect{v}}_B = \coord{T\vect{v}}_C
  \end{equation*}
  for all $\vect{v}\in V$.
\end{definition}

\begin{example}{Finding the matrix of a linear transformation}{matrix-of-linear-transformation-vector-space}
  Find the matrix of the derivative operator $D:\Poly_3\to\Poly_2$
  with respect to the basis $B=\set{1,x,x^2,x^3}$ of $\Poly_3$ and the
  basis $C=\set{1,x,x^2}$ of $\Poly_2$.
\end{example}

\begin{solution}
  We first find the images of each basis vector of the basis $B$, and
  we write each of them as a linear combination of basis vectors from
  the basis $C$. Let us denote the basis vectors of $B$ as
  $\vect{v}_1 = 1$, $\vect{v}_2 = x$, $\vect{v}_3 = x^2$, and
  $\vect{v}_4=x^3$, and the basis vectors of $C$ as $\vect{w}_1 = 1$,
  $\vect{w}_2 = x$, and $\vect{w}_3 = x^2$. We have
  \begin{equation*}
    \begin{array}{rclclclcl}
      D(\vect{v}_1) &=& D(1) &=& 0 &=& 0 + 0x + 0x^2 &=& 0\vect{w}_1 + 0\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_2) &=& D(x) &=& 1 &=& 1 + 0x + 0x^2 &=& 1\vect{w}_1 + 0\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_3) &=& D(x^2) &=& 2x &=& 0 + 2x + 0x^2 &=& 0\vect{w}_1 + 2\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_4) &=& D(x^3) &=& 3x^2 &=& 0 + 0x + 3x^2 &=& 0\vect{w}_1 + 0\vect{w}_2 + 3\vect{w}_3. \\
    \end{array}
  \end{equation*}
  Therefore, we have
  \begin{equation*}
    A=\coord{D}_{C,B} =
    \begin{mymatrix}{rrrr}
      0 & 1 & 0 & 0 \\
      0 & 0 & 2 & 0 \\
      0 & 0 & 0 & 3 \\
    \end{mymatrix}.
  \end{equation*}
\end{solution}

\begin{example}{Same linear transformation, different bases}{matrix-of-linear-transformation-vector-space2}
  Find the matrix of the derivative operator $D:\Poly_3\to\Poly_2$
  with respect to the basis $B'=\set{1,x+1,x^2+x+1,x^3+x^2+x+1}$ of
  $\Poly_3$ and the basis $C'=\set{1,x-1,x^2-1}$ of $\Poly_2$.
\end{example}

\begin{solution}
  This is the same linear transformation as in the previous example,
  but we are given different bases. Let us denote the basis vectors of
  $B'$ as $\vect{v}_1 = 1$, $\vect{v}_2 = x+1$, $\vect{v}_3 = x^2+x+1$, and
  $\vect{v}_4=x^3+x^2+x+1$, and the basis vectors of $C'$ as $\vect{w}_1 = 1$,
  $\vect{w}_2 = x-1$, and $\vect{w}_3 = x^2-1$. We must write each
  $D(\vect{v}_i)$ as a linear combination of $\vect{w}_1$,
  $\vect{w}_2$, and $\vect{w}_3$, which requires solving a system of
  linear equations for each of them. We have:
  \begin{equation*}
    \begin{array}{rclclcl}
      D(\vect{v}_1) &=& D(1) &=& 0 &=& 0\vect{w}_1 + 0\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_2) &=& D(x+1) &=& 1 &=& 1\vect{w}_1 + 0\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_3) &=& D(x^2+x+1) &=& 2x+1 &=& 3\vect{w}_1 + 2\vect{w}_2 + 0\vect{w}_3, \\
      D(\vect{v}_4) &=& D(x^3+x^2+x+1) &=& 3x^2+2x+1 &=& 6\vect{w}_1 + 2\vect{w}_2 + 3\vect{w}_3. \\
    \end{array}
  \end{equation*}
  Therefore, the matrix is
  \begin{equation*}
    \coord{D}_{C',B'} =
    \begin{mymatrix}{rrrr}
      0 & 1 & 3 & 6 \\
      0 & 0 & 2 & 2 \\
      0 & 0 & 0 & 3 \\
    \end{mymatrix}.
  \end{equation*}
\end{solution}

The last two examples illustrate that a linear transformation can have
many different matrices, because the matrix depends not only on the
linear transformation, but also on the given bases. The art of linear
algebra often lies in choosing ``convenient'' bases for a given
application. Often, a ``convenient'' basis is one that gives rise to
simple matrices, for example, matrices containing many zeros, or
matrices that are diagonal.

\begin{example}{Finding a convenient basis}{matrix-of-linear-transformation-vector-space3}
  Let $T:\Poly_3\to\Mat_{2,2}$ be the linear transformation
  defined by
  \begin{equation*}
    T(ax^3+bx^2+cx+d)=
    \begin{mymatrix}{cc} a+d & b-c \\ b+c & a-d \end{mymatrix}
  \end{equation*}
  for all $ax^3+bx^2+cx+d\in\Poly_3$. Let
  $B=\set{x^3, x^2, x, 1}$ and
  \begin{equation*}
    C=\set{
      \begin{mymatrix}{cc} 1 & 0 \\ 0 & 0 \end{mymatrix},
      \begin{mymatrix}{cc} 0 & 1 \\ 0 & 0 \end{mymatrix},
      \begin{mymatrix}{cc} 0 & 0 \\ 1 & 0 \end{mymatrix},
      \begin{mymatrix}{cc} 0 & 0 \\ 0 & 1 \end{mymatrix}
    }
  \end{equation*}
  be bases of $\Poly_3$ and $\Mat_{2,2}$, respectively.
  \begin{enumialphparenastyle}
    \begin{enumerate}
    \item Find $\coord{T}_{C,B}$.
    \item Find a basis $C'$ of $\Mat_{2,2}$ such that
      $\coord{T}_{C',B}$ is the identity matrix.
    \end{enumerate}
  \end{enumialphparenastyle}
\end{example}

\begin{solution}
  (a) We have
  \begin{equation*}
    \begin{array}{rcccl}
      T(x^3)
      &=& \begin{mymatrix}{rr} 1 & 0 \\ 0 & 1 \end{mymatrix}
      &=&
      1 \begin{mymatrix}{cc} 1 & 0 \\ 0 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 1 \\ 0 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 0 \\ 1 & 0 \end{mymatrix}
      + 1 \begin{mymatrix}{cc} 0 & 0 \\ 0 & 1 \end{mymatrix}, \\\\[-2ex]
      T(x^2)
      &=& \begin{mymatrix}{rr} 0 & 1 \\ 1 & 0 \end{mymatrix}
      &=&
      0 \begin{mymatrix}{cc} 1 & 0 \\ 0 & 0 \end{mymatrix}
      + 1 \begin{mymatrix}{cc} 0 & 1 \\ 0 & 0 \end{mymatrix}
      + 1 \begin{mymatrix}{cc} 0 & 0 \\ 1 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 0 \\ 0 & 1 \end{mymatrix}, \\\\[-2ex]
      T(x)
      &=& \begin{mymatrix}{rr} 0 & -1 \\ 1 & 0 \end{mymatrix}
      &=&
      0 \begin{mymatrix}{cc} 1 & 0 \\ 0 & 0 \end{mymatrix}
      - 1 \begin{mymatrix}{cc} 0 & 1 \\ 0 & 0 \end{mymatrix}
      + 1 \begin{mymatrix}{cc} 0 & 0 \\ 1 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 0 \\ 0 & 1 \end{mymatrix}, \\\\[-2ex]
      T(1)
      &=& \begin{mymatrix}{rr} 1 & 0 \\ 0 & -1 \end{mymatrix}
      &=&
      1 \begin{mymatrix}{cc} 1 & 0 \\ 0 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 1 \\ 0 & 0 \end{mymatrix}
      + 0 \begin{mymatrix}{cc} 0 & 0 \\ 1 & 0 \end{mymatrix}
      - 1 \begin{mymatrix}{cc} 0 & 0 \\ 0 & 1 \end{mymatrix}.
    \end{array}
  \end{equation*}
  Therefore,
  \begin{equation*}
    \coord{T}_{C,B}
    =
    \begin{mymatrix}{rrrr}
      1 & 0 &  0 &  1 \\
      0 & 1 & -1 &  0 \\
      0 & 1 &  1 &  0 \\
      1 & 0 &  0 & -1 \\
    \end{mymatrix}.
  \end{equation*}

  \noindent (b) Since the matrices $T(x^3)$, $T(x^2)$, $T(x)$, and $T(1)$
  form a basis of $\Mat_{2,2}$, we can take $C'$ to consist of
  these four matrices, i.e.,
  \begin{equation*}
    C' = \set{
      \begin{mymatrix}{cc} 1 &  0 \\ 0 &  1 \end{mymatrix},
      \begin{mymatrix}{cc} 0 &  1 \\ 1 &  0 \end{mymatrix},
      \begin{mymatrix}{cc} 0 & -1 \\ 1 &  0 \end{mymatrix},
      \begin{mymatrix}{cc} 1 &  0 \\ 0 & -1 \end{mymatrix}
    }.
  \end{equation*}
  Then
  \begin{equation*}
    \coord{T}_{C',B}
    =
    \begin{mymatrix}{rrrr}
      1 & 0 &  0 &  0 \\
      0 & 1 &  0 &  0 \\
      0 & 0 &  1 &  0 \\
      0 & 0 &  0 &  1 \\
    \end{mymatrix}
  \end{equation*}
  is the identity matrix.
\end{solution}

We end this section with some properties of matrices of linear
transformations.

\begin{proposition}{Properties of matrices of linear transformations}{matrix-of-linear-transformation-properties}
  Let $V$, $W$, and $U$ be finite-dimensional vector spaces with
  respective bases $B$, $C$, and $D$. Suppose $T,T':V\to W$ and
  $S:W\to U$ are linear transformations. The following hold:
  \begin{enumialphparenastyle}
    \begin{enumerate}
    \item $\coord{S\circ T}_{D,B} = \coord{S}_{D,C}\coord{T}_{C,B}$.
    \item $\coord{1_V}_{B,B} = I$.
    \item $T$ is invertible if and only if $\coord{T}_{C,B}$ is
      invertible, and in that case,
      $\coord{T^{-1}}_{B,C} = (\coord{T}_{C,B})^{-1}$.
    \item $\coord{0}_{C,B} = 0$.
    \item $\coord{T+T'}_{C,B} = \coord{T}_{C,B} + \coord{T'}_{C,B}$.
    \item $\coord{kT}_{C,B} = k\coord{T}_{C,B}$.
    \end{enumerate}
  \end{enumialphparenastyle}
\end{proposition}
